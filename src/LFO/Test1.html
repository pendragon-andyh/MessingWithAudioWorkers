<html>
  <head>
    <title>Testing LFO</title>
  </head>
  <body>
    <script>
      class SliderParam {
        constructor(node, name, initialValue = 0, minValue = 0, maxValue = 10){
          this._node=node;
          this._name=name;
          this._value=initialValue;
          this._minValue = minValue;
          this._maxValue = maxValue;
        }

        get name(){
          return this._name;
        }
        get value(){
          return this._value;
        }
        set value(newValue){
          this.node.postMessage({ subject: 'ParamSet', name:this._name, value:newValue });
          this._value=newValue;
        }
      }

      class LFONode extends AudioWorkletNode {
        constructor(context) {
          super(context, 'LFO-processor');

          this.lfoRate = new SliderParam(this, 'lfoRate');
        }

        createSliderProperty(name, initialValue = 0, minValue = 0, maxValue = 10){
            let myValue = initialValue;
            Object.defineProperty(this, name, {
              set: function(newValue){
                myValue=newValue;
              },
              get: function(){
                return myValue;
              }
            });
          }
      }

      let ac = new OfflineAudioContext(1, 44100, 44100);
      ac.audioWorklet.addModule("LFOProcessor.js").then(() =>{
        let node = new LFONode(ac);
        node.connect(ac.destination);

        node.myProperty = 123;

        ac.startRendering().then(x => {
          var d = x.getChannelData(0);
        });
      });
    </script>
  </body>
</html>
